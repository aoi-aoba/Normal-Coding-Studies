# 중국인의 나머지 정리 (Chinese Remainder Theorem, CRT)

## 🖋️ 모듈러 연산의 연립
> 지금 물건이 있는데, 그 개수는 알지 못한다. 다만, 3개씩 세면 1개 남고, 5개씩 세면 2개가 남으며, 7개씩 세면 3개가 남는다고 한다. 원래의 개수는 얼마인가?

경선징의 <묵사집산법>의 한시 중 아래에 문제가 남아 있다.  이 문제를 직접 풀어보자.   

1. **5와 7의 공배수 중 3으로 나누면 나머지가 1인 가장 작은 수**
	5와 7의 최소공배수는 35이고 3으로 나누면 나머지는 2
    2를 곱한 70은 3으로 나누면 나머지가 1이므로 70

2. **3와 7의 공배수 중 5로 나누면 나머지가 1인 가장 작은 수**
	7과 3의 최소공배수는 21이고 5로 나누면 나머지는 1이므로 21

3. **3와 5의 공배수 중 7로 나누면 나머지가 1인 가장 작은 수**
	3과 5의 최소공배수는 15이고 7로 나누면 나머지는 1이므로 15
    
즉, 이들을 활용하여
$$70 × 1 + 21 × 2 + 15 × 3 = 70 + 42 + 45 = 157$$이라는 값을 얻을 수 있다.

하지만 언급하지 않아도 조건을 만족하는 가장 작은 값을 찾는 것이 관례였다. 그래서 세 수의 최소공배수인 105를 몇 번 빼서 $$157 - 105 = 52$$의 형태로 답을 얻을 수 있다.
    

## 🖋️ 중국인의 나머지 정리
중국인의 나머지 정리란 이런 내용이다.
> 서로소인 정수 $$n_{1}, n_{2}, \dots, n_{k}$$에 대하여 연립 합동식 $$x \equiv a_1 \pmod{n_1}$$, $$x \equiv a_2 \pmod{n_2}$$, $$\dots$$ , $$x \equiv a_k \pmod{n_k}$$는 유일한 해 $$x$$를 가지며, 그 해는 $$N = n_{1} n_{2} \dots n_{k}$$에 대해 $$0 \leq x < N$$
 범위 내에서 존재한다.
 
 또한, 이 경우에서
 > 각 $$j = 1, 2, \dots, n$$에 대하여 합동식 $$\mu \frac{M}{m_{j}} = 1 \pmod{m_{j}}$$의 해를 $$\mu = a_{j}$$라 하면 연립 항등식의 일반해는 $$x = r_{1}a_{1}\frac{M}{m_{1}} + r_{2}a_{2}\frac{M}{m_{2}} + \dots + r_{n}a_{n}\frac{M}{m_{n}} \pmod{M}$$과 같다.

가 성립한다.

---

### ☑️ 도움정리 1
> 양의 정수 $$m$$과 $$a_{1}, a_{2}, \dots, a_{n}$$에 대하여 $$m$$이 이들과 각각 서로소이면 $$m$$과 $$a_{1} a_{2} \dots a_{k}$$도 소로소이다.

#### 도움정리 1 증명
서로소가 아니라고 가정하면, 그들의 소수인 공약수  $$p$$가 존재한다. 그러면 $$a_{1} a_{2} \dots a_{k}$$를 p로 나누면 나누어 떨어지므로 $$a_{n}$$ 중 하나는 p로 나누면 나누어 떨어진다. 여기에서 $$m$$과 $$a_{n}$$은 $$p$$에 대해 모두 나누어 떨어지므로 이는 처음에 전제한 서로소 조건에 모순이므로 가정이 틀렸다.

---

### ☑️ 도움정리 2
> 양의 정수 $$m$$과 $$a_{1}, a_{2}, \dots, a_{n}$$에 대하여 $$m$$이 이들과 각각 서로소이면 $$m$$은 $$a_{1}, a_{2}, \dots, a_{n}$$의 최소공배수의 배수이다.

#### 도움정리 2 증명

최소공배수 $$L$$에 대하여 나눗셈 정리(*임의의 정수 a, b에 대해 몫과 나머지는 유일하게 존재함*)를 적용하자.   
$$m = q L + r$$을 만족하는 정수 $$q, r$$이 유일하게 존재한다.    
단, 이때 $$0 \leq r < L$$이다.     
그런데 $$a_{i}$$는 $$m$$과 $$L$$의 약수이므로 $$r$$의 약수이기도 하다.
이는 모든 $$a_{i}$$에 대해 성립하므로 $$r$$은 $$L$$보다 작은 모든 $$a_{i}$$의 공배수이고 이는 $$r = 0$$일 때만 가능하다.    
따라서 $$m = q L$$이며 $$m$$이 $$L$$의 배수이다.

---

### ☑️ 도움정리 3
> 양의 정수 $$a_{1}, a_{2}, \dots, a_{n}$$에 대하여 $$a_{i}, a_{j}$$의 최대공약수가 1, 즉 각 쌍마다 서로소(*pairwise relatively prime*&ZeroWidthSpace;)이면 $$a_{1}, a_{2}, \dots, a_{n}$$의 최대공약수는 그들의 합과 같다.

자명한 내용이므로 증명하지 않는다.

## 🖋️ 중국인의 나머지 정리 - 존재성
처음에 주는 조건에 의해 $$m_{k}$$는 각각 쌍마다 서로소이다.   
$$m = m_{1}m_{2}\dots m_{n}$$이라 하고 $$n_k = \frac{m}{m_{k}}$$라고 하자.   
($$n_k$$는 $$m_k$$를 제외한 나머지의 곱이라고 하자)   
**도움정리 1**&ZeroWidthSpace;을 참고하면, $$n_{k}$$와 $$m_{k}$$의 최대공약수는 1이다.   
이때 배주 항등식(Bézout's Identity)에 의하여 $$s_{k}n_{k}+t_{k}m_{k}=1$$을 만족하는 정수 $s_{k}$와 $t_{k}$가 존재한다.

> **배주 항등식**
적어도 둘 중 하나는 0이 아닌 정수 $$a, b$$에 대하여 그들의 최대공약수가 $$d$$일 때,
1) $$d = ax+by$$를 만족하는 정수 $$x, y$$가 존재
2) $$d$$는 정수 $$x, y$$에 대하여 $$ax+by$$ 형태로 표현할 수 있는 가장 작은 자연수
3) 정수 $$x, y$$에 대하여 $$ax+by$$ 형태로 표현되는 모든 정수는 $$d$$의 배수

이는 곧 $$s_{k}n_{k} \equiv 1 \pmod{m_{k}}$$임을 알 수 있다.   
이제 $$x = a_{1}n_{1}s_{1} + a_{2}n_{2}s_{2} + \dots + a_{k}n_{k}s_{k}$$라고 하자.   
만약 $$j=k$$가 아니라면 $$m_{k}$$는 $$n_{j}$$에 대해 나누어 떨어지므로 이는 곧 $$x \equiv a_{k}n_{k}s_{k} \equiv a_{k} \pmod{m_{k}}$$임을 알 수 있다.    
이는 임의의 $$k$$에 대해 성립함에 따라 $$x$$가 주어진 연립항등식의 일반해 중 하나임을 알 수 있다.

## 🖋️ 중국인의 나머지 정리 - 유일성
$$x, y$$가 주어진 연립합동식의 해라고 가정하면 임의의 $$k$$에 대하여 $$x \equiv a_{k} \equiv y \pmod{m_{k}}$$이며 $$x-y \equiv 0 \pmod{m_k}$$이다. 즉 **도움정리 2**&ZeroWidthSpace;에 의하여 $$m_{1}, m_{2}, \dots, m_{n}$$의 최소공배수는 $$x-y$$의 약수이다.   
그런데 이들이 쌍마다 서로소이므로 **도움정리 3**&ZeroWidthSpace;에 의하여 이들의 최소공배수는 이들의 곱이고, 그 곱인 $$m$$은 $$x-y$$의 약수임을 알 수 있다.   
따라서 $$x \equiv y \pmod{m}$$임에 따라 주어진 연립합동식의 해가 유일함을 보인다.

## 연립합동식의 풀이법
해의 존재성을 증명하는 것과 비슷하다. 직접 풀어보자.

$$3, 5, 7$$이 쌍마다 서로소이므로 주어진 연립합동식이 $$3×5×7=105$$에 대하여 유일한 해를 가진다.
위에서 활용했듯 전체 곱에서 하나씩만을 나눈 $$n_{k}$$를 구하여 $$35, 21, 15$$를 얻을 수 있다.

- $$n_{1}s_{1} \equiv 35s_{1} \equiv 2s_{1} \equiv 1 \pmod{3}$$
- $$n_{2}s_{2} \equiv 21s_{2} \equiv s_{2} \equiv 1 \pmod{5}$$
- $$n_{3}s_{3} \equiv 15s_{1} \equiv s_{3} \equiv 1 \pmod{7}$$

이들을 가능한 해 중 아무거나 고른다.   
가장 작은 해로 가능해보이게 각각 $$2, 1, 1$$을 고르자.   
그러면
$$x \equiv a_{1}n_{1}s_{1} + a_{2}n_{2}s_{2} + a_{3}n_{3}s_{3} \equiv 2×35×2 + 3×21×1 + 2×15×1 \equiv 233 \equiv 23 \pmod{105}$$이다.
결국 주어진 연립 합동식의 해는 $$x \equiv 23 \pmod{105}$$이다.
