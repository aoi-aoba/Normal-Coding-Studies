# 소수 일반 대응 판별과 에라토스테네스의 체

## 🖋️ 소수의 판별

소수를 판별하기 위해서는 가장 대표적인 두 가지 방법을 사용한다. 하나는 역시 해당 수에 대해 자기 자신과 1을 제외한 약수가 존재하는지 일일이 확인해보는 방식이다. 손으로 한다면 비효율적이겠지만, 프로그램이나 기계를 활용하면 이 방법도 마냥 나쁜 방법은 아니다. 이 과정 역시 n까지 모두 확인하지 않고 **$$\sqrt{n}$$까지 확인함에 따라 효율성을 높일 수 있다.**

에라토스테네스의 체(Eratosthenes’ sieve)는 **임의 자연수에 대하여 해당 자연수 이하의 소수를 모두 찾는** 방법이다. 입자의 크기가 서로 다른 가루를 섞어 체에 걸러서 특정 크기 이하의 가루가 아래로 떨어지고 아닌 것만 체 위에 남는 것처럼 **합성수를 지우고 소수만 남긴다** 하여 이런 이름이 붙었다.
    

## 🖋️ 에라토스테네스의 체 알고리즘

1. $$1$$부터 $$n$$까지 자연수를 모두 나열한다.
2. $$1$$은 **소수도 합성수도 아니므로** 지운다.
3. 남은 자연수 중 가장 작은 소수인 $$2$$의 배수를 모두 지운다. 자기 자신은 지우지 않는다.
4. 그 다음 자연수 중 가장 작은 소수인 $$3$$의 배수를 모두 지운다. 자기 자신은 지우지 않는다.
5. 남은 자연수 중 가장 작은 수는 항상 소수이다. 이들을 자기 자신을 제외한 배수를 모두 지운다.
6. 남은 자연수 중에서 **가장 작은 수가 n의 제곱근을 넘을 때까지** 이 과정을 반복하면 남은 수가 모두 소수이다.

## 🖋️ 소수 판별에 도움이 되는 근거 정리들

### ☑️ 도움정리 1
> $$2$$ 이상의 정수 $$n$$의 소인수는 적어도 하나 존재한다.

#### 도움정리 1 증명
집합 $$S$$를 $$n$$의 약수 중 1보다 큰 약수의 전체집합으로 두자.   
이때 $$n$$은 자기 자신의 약수이며 $$n ≥ 2$$이므로 $$S$$는 공집합이 아니다.   
따라서 자연수에 대한 정렬원리(well-ordering principle) 적용이 가능하다.
> **자연수에 대한 정렬원리(well-ordering principle)**
자연수 집합 $$N$$의 공집합이 아닌 부분집합 $$S$$가 주어지면 그 집합 안에서는 최소의 원소(최솟값) $$a$$를 찾을 수 있다.

그러므로 $$S$$에 존재하는 최소인 원소를 $$s*$$라 두자.  
이 원소가 소수임을 보이기 위해 $$d$$를 $$s*$$의 1보다 큰 약수라 하자.    
그러면 $$d | s*$$, 즉 $$d$$로 나누어 떨어지고 $$s* | n$$ 이므로 $$d | n$$ 이다.
그런데 $$s*$$는 1보다 큰 $$n$$의 약수 중 가장 작은 수이다.  
이때 $$d = s*$$임이 보장되며 $$s*$$이 소수임이 입증된다.

---

#### 도움정리 2 유도

이제 양의 정수 $$n$$이 합성수라고 하자.   
그러면 $$n = kl$$, $$2 ≤ k ≤ l ≤ n-1$$인 두 정수 $$k, l$$이 존재한다.   
이때 $$2 ≤ k^2 ≤ kl = n$$ 이므로 $$2≤ k ≤ \sqrt{n}$$이다.   
또한, $$2 ≤ k$$이므로 **도움정리 1**&ZeroWidthSpace;을 사용할 수 있다.
즉, $$k$$의 소인수 $$p$$가 존재하고 $$p | k, k | n$$이므로 $$p | n$$이다.
그 결과 $$p ≤ k ≤ \sqrt{n}$$임에 따라 다음의 도움정리 2가 성립한다.


### ☑️ 도움정리 2
> 양의 정수 $$n$$이 합성수라면, $$n$$의 소인수 중에는 $$p ≤ \sqrt{n}$$인 소인수 $$p$$가 존재한다.

$$n$$ 이하의 합성수 $$m$$을 선택하면, **도움정리 2**&ZeroWidthSpace;에 의하여 $$\sqrt{m}$$보다 작거나 같은 소인수 $$p$$가 존재한다.   
그런데 $$m ≤ n$$이므로 $$p ≤ \sqrt{n}$$이다.   
따라서 $$\sqrt{n}$$보다 작은 소인수의 배수들만 지우면 $$n$$ 이하의 합성수는 모두 제거된다.   

## 도움정리를 활용하여 알 수 있는 점

도움정리 1을 통해 도움정리 2를 유도함에 따라,
- 에라토스테네스의 체에서 $$\sqrt{n}$$ 이하의 소수를 모두 활용하였다면 남은 수는 모두 소수가 된다.
- 일반적으로 자신과 1을 제외한 약수를 체크해볼 때 $$\sqrt{n}$$ 이하의 수를 모두 체크했을 때 약수가 없다면 소수이다.

의 두 가지 사실을 입증할 수 있다.
